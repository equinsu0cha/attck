
# Binary Padding

## Description

### MITRE Description

> Adversaries may use binary padding to add junk data and change the on-disk representation of malware. This can be done without affecting the functionality or behavior of a binary, but can increase the size of the binary beyond what some security tools are capable of handling due to file size limitations. 

Binary padding effectively changes the checksum of the file and can also be used to avoid hash-based blocklists and static anti-virus signatures.(Citation: ESET OceanLotus) The padding used is commonly generated by a function to create junk data and then appended to the end or applied to sections of malware.(Citation: Securelist Malware Tricks April 2017) Increasing the file size may decrease the effectiveness of certain tools and detection capabilities that are not designed or configured to scan large files. This may also reduce the likelihood of being collected for analysis. Public file scanning services, such as VirusTotal, limits the maximum size of an uploaded file to be analyzed.(Citation: VirusTotal FAQ) 

## Aliases

```

```

## Additional Attributes

* Bypass: ['Anti-virus', 'Signature-based detection']
* Effective Permissions: None
* Network: None
* Permissions: None
* Platforms: ['Linux', 'macOS', 'Windows']
* Remote: None
* Type: attack-pattern
* Wiki: https://attack.mitre.org/techniques/T1027/001

## Potential Commands

```
dd if=/dev/zero bs=1 count=1 >> /tmp/evil-binary
```

## Commands Dataset

```
[{'command': 'dd if=/dev/zero bs=1 count=1 >> /tmp/evil-binary\n',
  'name': None,
  'source': 'atomics/T1027.001/T1027.001.yaml'}]
```

## Potential Detections

```json

```

## Potential Queries

```json

```

## Raw Dataset

```json
[{'Atomic Red Team Test - Obfuscated Files or Information: Binary Padding': {'atomic_tests': [{'auto_generated_guid': 'ffe2346c-abd5-4b45-a713-bf5f1ebd573a',
                                                                                               'dependencies': [{'description': 'The '
                                                                                                                                'binary '
                                                                                                                                'must '
                                                                                                                                'exist '
                                                                                                                                'on '
                                                                                                                                'disk '
                                                                                                                                'at '
                                                                                                                                'specified '
                                                                                                                                'location '
                                                                                                                                '(#{file_to_pad})\n',
                                                                                                                 'get_prereq_command': 'cp '
                                                                                                                                       '/bin/ls '
                                                                                                                                       '#{file_to_pad}\n',
                                                                                                                 'prereq_command': 'if '
                                                                                                                                   '[ '
                                                                                                                                   '-f '
                                                                                                                                   '#{file_to_pad} '
                                                                                                                                   ']; '
                                                                                                                                   'then '
                                                                                                                                   'exit '
                                                                                                                                   '0; '
                                                                                                                                   'else '
                                                                                                                                   'exit '
                                                                                                                                   '1; '
                                                                                                                                   'fi;\n'}],
                                                                                               'dependency_executor_name': 'bash',
                                                                                               'description': 'Uses '
                                                                                                              'dd '
                                                                                                              'to '
                                                                                                              'add '
                                                                                                              'a '
                                                                                                              'zero '
                                                                                                              'to '
                                                                                                              'the '
                                                                                                              'binary '
                                                                                                              'to '
                                                                                                              'change '
                                                                                                              'the '
                                                                                                              'hash.\n'
                                                                                                              '\n'
                                                                                                              'Upon '
                                                                                                              'successful '
                                                                                                              'execution, '
                                                                                                              'dd '
                                                                                                              'will '
                                                                                                              'modify '
                                                                                                              '`/tmp/evil-binary`, '
                                                                                                              'therefore '
                                                                                                              'the '
                                                                                                              'expected '
                                                                                                              'hash '
                                                                                                              'will '
                                                                                                              'change.\n',
                                                                                               'executor': {'cleanup_command': 'rm '
                                                                                                                               '#{file_to_pad}\n',
                                                                                                            'command': 'dd '
                                                                                                                       'if=/dev/zero '
                                                                                                                       'bs=1 '
                                                                                                                       'count=1 '
                                                                                                                       '>> '
                                                                                                                       '#{file_to_pad}\n',
                                                                                                            'name': 'sh'},
                                                                                               'input_arguments': {'file_to_pad': {'default': '/tmp/evil-binary',
                                                                                                                                   'description': 'Path '
                                                                                                                                                  'of '
                                                                                                                                                  'binary '
                                                                                                                                                  'to '
                                                                                                                                                  'be '
                                                                                                                                                  'padded',
                                                                                                                                   'type': 'Path'}},
                                                                                               'name': 'Pad '
                                                                                                       'Binary '
                                                                                                       'to '
                                                                                                       'Change '
                                                                                                       'Hash '
                                                                                                       '- '
                                                                                                       'Linux/macOS '
                                                                                                       'dd',
                                                                                               'supported_platforms': ['macos',
                                                                                                                       'linux']}],
                                                                             'attack_technique': 'T1027.001',
                                                                             'display_name': 'Obfuscated '
                                                                                             'Files '
                                                                                             'or '
                                                                                             'Information: '
                                                                                             'Binary '
                                                                                             'Padding'}}]
```

# Tactics


* [Defense Evasion](../tactics/Defense-Evasion.md)


# Mitigations

None

# Actors


* [APT32](../actors/APT32.md)

* [Patchwork](../actors/Patchwork.md)
    
* [Moafee](../actors/Moafee.md)
    
* [Leviathan](../actors/Leviathan.md)
    
* [BRONZE BUTLER](../actors/BRONZE-BUTLER.md)
    
* [Gamaredon Group](../actors/Gamaredon-Group.md)
    
