
# Exploit Public-Facing Application

## Description

### MITRE Description

> Adversaries may attempt to take advantage of a weakness in an Internet-facing computer or program using software, data, or commands in order to cause unintended or unanticipated behavior. The weakness in the system can be a bug, a glitch, or a design vulnerability. These applications are often websites, but can include databases (like SQL)(Citation: NVD CVE-2016-6662), standard services (like SMB(Citation: CIS Multiple SMB Vulnerabilities) or SSH), and any other applications with Internet accessible open sockets, such as web servers and related services.(Citation: NVD CVE-2014-7169) Depending on the flaw being exploited this may include [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211).

If an application is hosted on cloud-based infrastructure, then exploiting it may lead to compromise of the underlying instance. This can allow an adversary a path to access the cloud APIs or to take advantage of weak identity and access management policies.

For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.(Citation: OWASP Top 10)(Citation: CWE top 25)

## Aliases

```

```

## Additional Attributes

* Bypass: None
* Effective Permissions: None
* Network: None
* Permissions: None
* Platforms: ['Linux', 'Windows', 'macOS', 'AWS', 'GCP', 'Azure']
* Remote: None
* Type: attack-pattern
* Wiki: https://attack.mitre.org/techniques/T1190

## Potential Commands

```
powershell/lateral_movement/jenkins_script_console
python/exploit/web/jboss_jmx
```

## Commands Dataset

```
[{'command': 'powershell/lateral_movement/jenkins_script_console',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'},
 {'command': 'powershell/lateral_movement/jenkins_script_console',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'},
 {'command': 'python/exploit/web/jboss_jmx',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'},
 {'command': 'python/exploit/web/jboss_jmx',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'}]
```

## Potential Detections

```json
[{'data_source': {'author': 'Florian Roth',
                  'date': '2018/07/22',
                  'description': 'Detects access to a webshell droped into a '
                                 'keytore folder on the WebLogic server',
                  'detection': {'condition': 'selection',
                                'selection': {'c-uri-path': ['*/config/keystore/*.js*']}},
                  'falsepositives': ['Unknown'],
                  'fields': ['c-ip', 'c-dns'],
                  'id': '37e8369b-43bb-4bf8-83b6-6dd43bda2000',
                  'level': 'critical',
                  'logsource': {'category': 'webserver'},
                  'references': ['https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2894',
                                 'https://twitter.com/pyn3rd/status/1020620932967223296',
                                 'https://github.com/LandGrey/CVE-2018-2894'],
                  'status': 'experimental',
                  'tags': ['attack.t1100',
                           'attack.t1190',
                           'attack.initial_access',
                           'attack.persistence',
                           'attack.privilege_escalation',
                           'cve.2018-2894'],
                  'title': 'Oracle WebLogic Exploit'}},
 {'data_source': {'author': 'Lionel PRAT, Christophe BROCAS, @atc_project '
                            '(improvements)',
                  'description': 'Detect suspicious error on protocol RDP, '
                                 'potential CVE-2019-0708',
                  'detection': {'condition': 'selection',
                                'selection': {'EventID': [56, 50],
                                              'Source': 'TermDD'}},
                  'falsepositives': ['Bad connections or network '
                                     'interruptions'],
                  'id': 'aaa5b30d-f418-420b-83a0-299cb6024885',
                  'level': 'high',
                  'logsource': {'product': 'windows', 'service': 'system'},
                  'references': ['https://github.com/zerosum0x0/CVE-2019-0708',
                                 'https://github.com/Ekultek/BlueKeep'],
                  'status': 'experimental',
                  'tags': ['attack.initial_access',
                           'attack.lateral_movement',
                           'attack.t1210',
                           'attack.t1190',
                           'car.2013-07-002'],
                  'title': 'Potential RDP exploit CVE-2019-0708'}},
 {'data_source': ['Application logs']},
 {'data_source': ['Packet capture']},
 {'data_source': ['Web logs']},
 {'data_source': ['Web application firewall logs']},
 {'data_source': ['Application logs']},
 {'data_source': ['Packet capture']},
 {'data_source': ['Web logs']},
 {'data_source': ['Web application firewall logs']}]
```

## Potential Queries

```json
[{'name': 'Yml',
  'product': 'https://raw.githubusercontent.com/12306Bro/Threathunting-book/master/{}',
  'query': 'Yml\n'
           'title: CVE-2020-0688 Exchange Exploitation via Web Log\n'
           'id: fce2c2e2-0fb5-41ab-a14c-5391e1fd70a5\n'
           'status: experimental\n'
           'description: Detects the exploitation of Microsoft Exchange '
           'vulnerability as described in CVE-2020-0688\n'
           'references:\n'
           '    - '
           'https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/\n'
           'author: Florian Roth\n'
           'date: 2020/02/29\n'
           'logsource:\n'
           '    category: webserver\n'
           'detection:\n'
           '    selection1:\n'
           "        cs-method: 'GET'\n"
           '        c-uri | contains:\n'
           "            - '/ ecp /'\n"
           "            - '/ owa /'\n"
           '    selection2:\n'
           "        c-uri | contains: '__VIEWSTATE ='\n"
           '    condition: selection1 and selection2\n'
           'fields:\n'
           '    - c-ip\n'
           '    - c-dns\n'
           'falsepositives:\n'
           '    - Unknown\n'
           'tags:\n'
           '    - attack.initial_access\n'
           '    - attack.t1190\n'
           'level: critical'},
 {'name': 'Yml',
  'product': 'https://raw.githubusercontent.com/12306Bro/Threathunting-book/master/{}',
  'query': 'Yml\n'
           'title: CVE-2020-0688 Exploitation via Eventlog\n'
           'id: d6266bf5-935e-4661-b477-78772735a7cb\n'
           'status: experimental\n'
           'description: Detects the exploitation of Microsoft Exchange '
           'vulnerability as described in CVE-2020-0688\n'
           'references:\n'
           '    - '
           'https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/\n'
           'author: Florian Roth\n'
           'date: 2020/02/29\n'
           'tags:\n'
           '    - attack.initial_access\n'
           '    - attack.t1190\n'
           'logsource:\n'
           '    product: windows\n'
           '    service: application\n'
           'detection:\n'
           '    selection1:\n'
           '        EventID: 4\n'
           '        Source: MSExchange Control Panel\n'
           '        Level: Error\n'
           '    selection2:\n'
           "        - '* & __ VIEWSTATE = *'\n"
           '    condition: selection1 and selection2\n'
           'falsepositives:\n'
           '    - Unknown\n'
           'level: high'},
 {'name': 'Yml',
  'product': 'https://raw.githubusercontent.com/12306Bro/Threathunting-book/master/{}',
  'query': 'Yml\n'
           'title: CVE-2020-0688 Exploitation IIS Eventlog\n'
           'id: d6266bf5-935e-4661-b477-78772735a7cb\n'
           'status: experimental\n'
           'description: Detects the exploitation of Microsoft Exchange '
           'vulnerability as described in CVE-2020-0688\n'
           'references:\n'
           '    - '
           'https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/\n'
           'author: Florian Roth\n'
           'date: 2020/02/29\n'
           'tags:\n'
           '    - attack.initial_access\n'
           '    - attack.t1190\n'
           'logsource:\n'
           '    product: windows\n'
           '    service: IIS\n'
           'detection:\n'
           '    selection1:\n'
           "        cs-method: 'POST'\n"
           "        c-uri | contains: '/owa/auth.owa'\n"
           '    selection2:\n'
           "        cs-method: 'GET'\n"
           "        c-uri | contains: '__VIEWSTATEGENERATOR = * __VIEWSTATE "
           "='\n"
           '    timeframe: 3s # can be adjusted according to actual situation\n'
           '    condition: selection1 and selection2\n'
           'falsepositives:\n'
           '    - Unknown\n'
           'level: high'},
 {'name': 'Yml',
  'product': 'https://raw.githubusercontent.com/12306Bro/Threathunting-book/master/{}',
  'query': 'Yml\n'
           'title: landing from the public network failure behavior\n'
           'description: log on from a public IP network boundary may indicate '
           'firewall or configuration errors.\n'
           'author: NVISO 12306Br0 (translation + test)\n'
           'date: 2020/05/06\n'
           'tags:\n'
           '    - attack.initial_access\n'
           '    - attack.persistence\n'
           '    - attack.t1078\n'
           '    - attack.t1190\n'
           '    - attack.t1133\n'
           'logsource:\n'
           '    product: windows\n'
           '    service: security\n'
           'detection:\n'
           '    selection:\n'
           '        EventID: 4625 # landing failed\n'
           '    unknown:\n'
           "        IpAddress | contains: '-'\n"
           '    privatev4:\n'
           '        IpAddress | startswith:\n'
           "            -. '10 '# 10.0.0.0 / 8\n"
           "            - '. 192.168' # 192.168.0.0 / 16\n"
           "            - '. 172.16' # 172.16.0.0 / 12\n"
           "            - '172.17.'\n"
           "            - '172.18.'\n"
           "            - '172.19.'\n"
           "            - '172.20.'\n"
           "            - '172.21.'\n"
           "            - '172.22.'\n"
           "            - '172.23.'\n"
           "            - '172.24.'\n"
           "            - '172.25.'\n"
           "            - '172.26.'\n"
           "            - '172.27.'\n"
           "            - '172.28.'\n"
           "            - '172.29.'\n"
           "            - '172.30.'\n"
           "            - '172.31.'\n"
           "            - '127.' # 127.0.0.0 / 8\n"
           "            - '. 169.254' # 169.254.0.0 / 16\n"
           '    privatev6:\n'
           "        - IpAddress: ':: 1' #loopback\n"
           '        - IpAddress | startswith:\n'
           "            - 'fe80 ::' # link-local\n"
           "            - 'fc00 ::' #unique local\n"
           '    condition: selection and not (unknown or privatev4 or '
           'privatev6)\n'
           'falsepositives:\n'
           '    - legal attempt to log on the Internet\n'
           '    - IPv4 to IPv6 mapping of IP\n'
           'level: medium'},
 {'name': 'Yml',
  'product': 'https://raw.githubusercontent.com/12306Bro/Threathunting-book/master/{}',
  'query': 'Yml\n'
           'title: Suspicious SQL error message\n'
           'status: the experimental stage\n'
           'description: detecting an indication of an error message SQL '
           'injection attacks detected\n'
           'author: Bjoern Kimminich\n'
           'Translator: 12306Bro\n'
           'date: 2020/8/6\n'
           'references:\n'
           '    - http://www.sqlinjection.net/errors\n'
           'logsource:\n'
           '    category: application\n'
           '    product: sql\n'
           'detection:\n'
           '    keywords:\n'
           '        # Oracle\n'
           '        - quoted string not properly terminated\n'
           '        # MySQL\n'
           '        - You have an error in your SQL syntax\n'
           '        # SQL Server\n'
           '        - Unclosed quotation mark\n'
           '        # SQLite\n'
           '        - \'near "*": syntax error\'\n'
           '        - SELECTs to the left and right of UNION do not have the '
           'same number of result columns\n'
           '    condition: keywords\n'
           'falsepositives:\n'
           '    - Application bugs\n'
           'level: high'}]
```

## Raw Dataset

```json
[{'Empire Module XLSX Sheet by dstepanic': {'ATT&CK Technique #1': 'T1190',
                                            'ATT&CK Technique #2': '',
                                            'Concatenate for Python Dictionary': '"powershell/lateral_movement/jenkins_script_console":  '
                                                                                 '["T1190"],',
                                            'Empire Module': 'powershell/lateral_movement/jenkins_script_console',
                                            'Technique': 'Exploit '
                                                         'Public-Facing '
                                                         'Application'}},
 {'Empire Module XLSX Sheet by dstepanic': {'ATT&CK Technique #1': 'T1190',
                                            'ATT&CK Technique #2': '',
                                            'Concatenate for Python Dictionary': '"python/exploit/web/jboss_jmx":  '
                                                                                 '["T1190"],',
                                            'Empire Module': 'python/exploit/web/jboss_jmx',
                                            'Technique': 'Exploit '
                                                         'Public-Facing '
                                                         'Application'}}]
```

# Tactics


* [Initial Access](../tactics/Initial-Access.md)


# Mitigations


* [Exploit Public-Facing Application Mitigation](../mitigations/Exploit-Public-Facing-Application-Mitigation.md)

* [Update Software](../mitigations/Update-Software.md)
    
* [Application Isolation and Sandboxing](../mitigations/Application-Isolation-and-Sandboxing.md)
    
* [Privileged Account Management](../mitigations/Privileged-Account-Management.md)
    
* [Network Segmentation](../mitigations/Network-Segmentation.md)
    
* [Exploit Protection](../mitigations/Exploit-Protection.md)
    
* [Vulnerability Scanning](../mitigations/Vulnerability-Scanning.md)
    

# Actors


* [Night Dragon](../actors/Night-Dragon.md)

* [Axiom](../actors/Axiom.md)
    
* [Soft Cell](../actors/Soft-Cell.md)
    
* [APT41](../actors/APT41.md)
    
* [BlackTech](../actors/BlackTech.md)
    
* [APT39](../actors/APT39.md)
    
* [Rocke](../actors/Rocke.md)
    
* [Blue Mockingbird](../actors/Blue-Mockingbird.md)
    
