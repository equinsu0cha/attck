
# Exploitation for Defense Evasion

## Description

### MITRE Description

> Adversaries may exploit a system or application vulnerability to bypass security features. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code.Â Vulnerabilities may exist in defensive security software that can be used to disable or circumvent them.

Adversaries may have prior knowledge through reconnaissance that security software exists within an environment or they may perform checks during or shortly after the system is compromised for [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001). The security software will likely be targeted directly for exploitation. There are examples of antivirus software being targeted by persistent threat groups to avoid detection.

## Aliases

```

```

## Additional Attributes

* Bypass: ['Anti-virus', 'System access controls']
* Effective Permissions: None
* Network: None
* Permissions: ['User']
* Platforms: ['Linux', 'Windows', 'macOS']
* Remote: None
* Type: attack-pattern
* Wiki: https://attack.mitre.org/techniques/T1211

## Potential Commands

```

```

## Commands Dataset

```

```

## Potential Detections

```json
[{'data_source': {'author': 'Florian Roth',
                  'date': '2017/11/23',
                  'description': 'Detects exploits that use CVE-2017-11882 to '
                                 'start EQNEDT32.EXE and other sub processes '
                                 'like mshta.exe',
                  'detection': {'condition': 'selection',
                                'selection': {'ParentImage': '*\\EQNEDT32.EXE'}},
                  'falsepositives': ['unknown'],
                  'fields': ['CommandLine'],
                  'id': '678eb5f4-8597-4be6-8be7-905e4234b53a',
                  'level': 'critical',
                  'logsource': {'category': 'process_creation',
                                'product': 'windows'},
                  'references': ['https://www.hybrid-analysis.com/sample/2a4ae284c76f868fc51d3bb65da8caa6efacb707f265b25c30f34250b76b7507?environmentId=100',
                                 'https://www.google.com/url?hl=en&q=https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about&source=gmail&ust=1511481120837000&usg=AFQjCNGdL7gVwLXaNSl2Td8ylDYbSJFmPw'],
                  'status': 'experimental',
                  'tags': ['attack.defense_evasion', 'attack.t1211'],
                  'title': 'Droppers exploiting CVE-2017-11882'}},
 {'data_source': {'author': 'Florian Roth',
                  'date': '2017/05/09',
                  'description': 'This rule detects a suspicious crash of the '
                                 'Microsoft Malware Protection Engine',
                  'detection': {'condition': '1 of selection* and all of '
                                             'keywords',
                                'keywords': {'Message': ['*MsMpEng.exe*',
                                                         '*mpengine.dll*']},
                                'selection1': {'EventID': 1000,
                                               'Source': 'Application Error'},
                                'selection2': {'EventID': 1001,
                                               'Source': 'Windows Error '
                                                         'Reporting'}},
                  'falsepositives': ['MsMpEng.exe can crash when C:\\ is full'],
                  'id': '6c82cf5c-090d-4d57-9188-533577631108',
                  'level': 'high',
                  'logsource': {'product': 'windows', 'service': 'application'},
                  'references': ['https://bugs.chromium.org/p/project-zero/issues/detail?id=1252&desc=5',
                                 'https://technet.microsoft.com/en-us/library/security/4022344'],
                  'status': 'experimental',
                  'tags': ['attack.defense_evasion',
                           'attack.t1089',
                           'attack.t1211'],
                  'title': 'Microsoft Malware Protection Engine Crash'}},
 {'data_source': ['4688', 'Process Execution']},
 {'data_source': ['4663', 'File monitoring']},
 {'data_source': ['1000', '1001', 'Windows Error Reporting']},
 {'data_source': ['4688', 'Process Execution']},
 {'data_source': ['4663', 'File monitoring']},
 {'data_source': ['1000', '1001', 'Windows Error Reporting']}]
```

## Potential Queries

```json

```

## Raw Dataset

```json

```

# Tactics


* [Defense Evasion](../tactics/Defense-Evasion.md)


# Mitigations


* [Exploitation for Defense Evasion Mitigation](../mitigations/Exploitation-for-Defense-Evasion-Mitigation.md)

* [Update Software](../mitigations/Update-Software.md)
    
* [Exploit Protection](../mitigations/Exploit-Protection.md)
    
* [Threat Intelligence Program](../mitigations/Threat-Intelligence-Program.md)
    
* [Application Isolation and Sandboxing](../mitigations/Application-Isolation-and-Sandboxing.md)
    

# Actors


* [APT28](../actors/APT28.md)

