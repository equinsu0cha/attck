
# Exploitation of Remote Services

## Description

### MITRE Description

> Adversaries may exploit remote services to gain unauthorized access to internal systems once inside of a network. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code.Â A common goal for post-compromise exploitation of remote services is for lateral movement to enable access to a remote system.

An adversary may need to determine if the remote system is in a vulnerable state, which may be done through [Network Service Scanning](https://attack.mitre.org/techniques/T1046) or other Discovery methods looking for common, vulnerable software that may be deployed in the network, the lack of certain patches that may indicate vulnerabilities,  or security software that may be used to detect or contain remote exploitation. Servers are likely a high value target for lateral movement exploitation, but endpoint systems may also be at risk if they provide an advantage or access to additional resources.

There are several well-known vulnerabilities that exist in common services such as SMB (Citation: CIS Multiple SMB Vulnerabilities) and RDP (Citation: NVD CVE-2017-0176) as well as applications that may be used within internal networks such as MySQL (Citation: NVD CVE-2016-6662) and web server services. (Citation: NVD CVE-2014-7169)

Depending on the permissions level of the vulnerable remote service an adversary may achieve [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068) as a result of lateral movement exploitation as well.

## Aliases

```

```

## Additional Attributes

* Bypass: None
* Effective Permissions: None
* Network: None
* Permissions: ['User']
* Platforms: ['Linux', 'Windows', 'macOS']
* Remote: None
* Type: attack-pattern
* Wiki: https://attack.mitre.org/techniques/T1210

## Potential Commands

```
powershell/exploitation/exploit_jboss
powershell/exploitation/exploit_jboss
powershell/exploitation/exploit_jenkins
powershell/exploitation/exploit_jenkins
powershell/situational_awareness/network/get_exploitable_system
powershell/situational_awareness/network/get_exploitable_system
powershell/exploitation/exploit_eternalblue
powershell/exploitation/exploit_eternalblue
```

## Commands Dataset

```
[{'command': 'powershell/exploitation/exploit_jboss',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'},
 {'command': 'powershell/exploitation/exploit_jboss',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'},
 {'command': 'powershell/exploitation/exploit_jenkins',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'},
 {'command': 'powershell/exploitation/exploit_jenkins',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'},
 {'command': 'powershell/situational_awareness/network/get_exploitable_system',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'},
 {'command': 'powershell/situational_awareness/network/get_exploitable_system',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'},
 {'command': 'powershell/exploitation/exploit_eternalblue',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'},
 {'command': 'powershell/exploitation/exploit_eternalblue',
  'name': 'Empire Module Command',
  'source': 'https://github.com/dstepanic/attck_empire/blob/master/Empire_modules.xlsx?raw=true'}]
```

## Potential Detections

```json
[{'data_source': {'author': 'Markus Neis - Swisscom',
                  'date': '2019/05/15',
                  'description': 'Detects Non-Standard Tools Connecting to TCP '
                                 'port 3389 indicating possible lateral '
                                 'movement',
                  'detection': {'condition': 'selection and not filter',
                                'filter': {'Image': ['*\\mstsc.exe',
                                                     '*\\RTSApp.exe',
                                                     '*\\RTS2App.exe',
                                                     '*\\RDCMan.exe',
                                                     '*\\ws_TunnelService.exe',
                                                     '*\\RSSensor.exe',
                                                     '*\\RemoteDesktopManagerFree.exe',
                                                     '*\\RemoteDesktopManager.exe',
                                                     '*\\RemoteDesktopManager64.exe',
                                                     '*\\mRemoteNG.exe',
                                                     '*\\mRemote.exe',
                                                     '*\\Terminals.exe',
                                                     '*\\spiceworks-finder.exe',
                                                     '*\\FSDiscovery.exe',
                                                     '*\\FSAssessment.exe',
                                                     '*\\MobaRTE.exe',
                                                     '*\\chrome.exe',
                                                     '*\\thor.exe',
                                                     '*\\thor64.exe']},
                                'selection': {'DestinationPort': 3389,
                                              'EventID': 3,
                                              'Initiated': 'true'}},
                  'falsepositives': ['Other Remote Desktop RDP tools'],
                  'id': 'ed74fe75-7594-4b4b-ae38-e38e3fd2eb23',
                  'level': 'high',
                  'logsource': {'product': 'windows', 'service': 'sysmon'},
                  'references': ['https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708'],
                  'status': 'experimental',
                  'tags': ['attack.lateral_movement',
                           'attack.t1210',
                           'car.2013-07-002'],
                  'title': 'Suspicious Outbound RDP Connections'}},
 {'data_source': {'author': 'Florian Roth (rule), Adam Bradbury (idea)',
                  'date': '2019/06/02',
                  'description': 'Detects the use of a scanner by zerosum0x0 '
                                 'that discovers targets vulnerable to  '
                                 'CVE-2019-0708 RDP RCE aka BlueKeep',
                  'detection': {'condition': 'selection',
                                'selection': {'AccountName': 'AAAAAAA',
                                              'EventID': 4625}},
                  'falsepositives': ['Unlikely'],
                  'id': '8400629e-79a9-4737-b387-5db940ab2367',
                  'level': 'critical',
                  'logsource': {'product': 'windows', 'service': 'security'},
                  'references': ['https://twitter.com/AdamTheAnalyst/status/1134394070045003776',
                                 'https://github.com/zerosum0x0/CVE-2019-0708'],
                  'tags': ['attack.lateral_movement',
                           'attack.t1210',
                           'car.2013-07-002'],
                  'title': 'Scanner PoC for CVE-2019-0708 RDP RCE vuln'}},
 {'data_source': ['4688', 'Process Execution']},
 {'data_source': ['4663', 'File monitoring']},
 {'data_source': ['1000', ' 1001', 'Windows Error Reporting']},
 {'data_source': ['4688', 'Process Execution']},
 {'data_source': ['4663', 'File monitoring']},
 {'data_source': ['1000', ' 1001', 'Windows Error Reporting']}]
```

## Potential Queries

```json

```

## Raw Dataset

```json
[{'Empire Module XLSX Sheet by dstepanic': {'ATT&CK Technique #1': 'T1210',
                                            'ATT&CK Technique #2': 'T1190',
                                            'Concatenate for Python Dictionary': '"powershell/exploitation/exploit_jboss":  '
                                                                                 '["T1210","T1190"],',
                                            'Empire Module': 'powershell/exploitation/exploit_jboss',
                                            'Technique': 'Exploitation of '
                                                         'Remote Services'}},
 {'Empire Module XLSX Sheet by dstepanic': {'ATT&CK Technique #1': 'T1210',
                                            'ATT&CK Technique #2': 'T1190',
                                            'Concatenate for Python Dictionary': '"powershell/exploitation/exploit_jenkins":  '
                                                                                 '["T1210","T1190"],',
                                            'Empire Module': 'powershell/exploitation/exploit_jenkins',
                                            'Technique': 'Exploitation of '
                                                         'Remote Services'}},
 {'Empire Module XLSX Sheet by dstepanic': {'ATT&CK Technique #1': 'T1210',
                                            'ATT&CK Technique #2': '',
                                            'Concatenate for Python Dictionary': '"powershell/situational_awareness/network/get_exploitable_system":  '
                                                                                 '["T1210"],',
                                            'Empire Module': 'powershell/situational_awareness/network/get_exploitable_system',
                                            'Technique': 'Exploitation of '
                                                         'Remote Services'}},
 {'Empire Module XLSX Sheet by dstepanic': {'ATT&CK Technique #1': 'T1210',
                                            'ATT&CK Technique #2': 'T1212',
                                            'Concatenate for Python Dictionary': '"powershell/exploitation/exploit_eternalblue":  '
                                                                                 '["T1210","T1212"],',
                                            'Empire Module': 'powershell/exploitation/exploit_eternalblue',
                                            'Technique': 'Exploitation of '
                                                         'Remote Services'}}]
```

# Tactics


* [Lateral Movement](../tactics/Lateral-Movement.md)


# Mitigations


* [Exploitation of Remote Services Mitigation](../mitigations/Exploitation-of-Remote-Services-Mitigation.md)

* [Vulnerability Scanning](../mitigations/Vulnerability-Scanning.md)
    
* [Update Software](../mitigations/Update-Software.md)
    
* [Threat Intelligence Program](../mitigations/Threat-Intelligence-Program.md)
    
* [Privileged Account Management](../mitigations/Privileged-Account-Management.md)
    
* [Network Segmentation](../mitigations/Network-Segmentation.md)
    
* [Exploit Protection](../mitigations/Exploit-Protection.md)
    
* [Disable or Remove Feature or Program](../mitigations/Disable-or-Remove-Feature-or-Program.md)
    
* [Application Isolation and Sandboxing](../mitigations/Application-Isolation-and-Sandboxing.md)
    

# Actors


* [APT28](../actors/APT28.md)

* [Threat Group-3390](../actors/Threat-Group-3390.md)
    
