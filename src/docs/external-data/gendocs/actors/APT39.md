
# APT39

```
@@@@@@@@@@@@@@@@@@@@@@@@@@@,...............,,,;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@,,................,;;++*S@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;,...............,:::;;;++;;+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@............,,,,,::::;;;;;;:,:*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@S+......,,,,,,,,:::;;;;;;:,,,,::@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@####*,.,,,,,,,,,,,,:;;;;;;,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@####%?*:,,,,,,,,,,,:;;;;;:,,,,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##S?***+,,,,,,,,,:;;;;::,,,,,,,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#%***+:,,,,,,,,::::;;::,,,,,,,,,,,,,,,,,,;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@S?**;,,,,,,,,,,:::::::;+::::::,,,,,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@+?*;,,,,,,,,,,:::::,,:+%+:::::::::,,,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@,:;,,,,,,,,,,:::::,,,,*SS+:::::::::::,,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@,,,,,,,,,,,,:::::,,::;?SSS*++;;:::::::::,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@+:,,.,,,,,,,,,:::,:::;;+%SSSS******+;:::::::,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@;,,,.,,,,,,,,,,,,,::;;;;+%SSSSS********+;::::::,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@:,,,,,,,,,,,,,,,,,,:;;;;;*SSSSSS%**********+;:::::,,,,,,,,,;@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@:,,,,,,,,,,,,,,,,,,:;;;;;+?SSSSSSS%************+::::::,,,,,,,,@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@:,,,,,,,,,,,,,,,,,,,:;;;;;+%SSSSSSSS?+************+;:::::,,,,,,,:@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@,,,,,,,,,,,,,,,.,,,,,:;;+++*%SSSSSSSS%****************;::::,,,,,,,,+@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@,...,,,,,,,,,,,,..,::::+++++*%SSSSS%%%%?*****************;::::,,,,,,,,@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@,,..,,,,,,,,,,,,..,:::+++++?SSSS%%%%%%?*?????************+:::::,,,,,,,:@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@*,..,,,,,,,,,,,.,:::++++*?S%SS%%%%%%??????????*****+++***+::::::,,,,,,@SSS@@@@@@@@@@@@@@@
@@@@@@@@@@@@@,,.....,,,,,..,::++***%S%S%%%%%%%?????????????**+;;;+***;:+*?*+,,,,;SSSSS#@@@@@@@@@@@@@
@@@@@@@@@@@@@@;,......,...,,:;***?%SSS%%%%%%%?*????????????*+;;;;;+****???%?+,,:?S%%SSS@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@,.........,::+**?%S%%%%%%%%%?*?????????????*+;;:;;;+**??**?%?:,+%%*+?SSS@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@:,......,,:;**?SSS?*?%?*?%%**?????????????*;;:::;;+*?%?***??;,*%%++?SSS@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@:,,.....,,:+*%S%SS?%????*%?***?????**?????*;;;:;;;+**%?*?*??:,*%%*+%SSS@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@,,,,....,:;*%SSSSS??%%%%???****??*+++**???*+;;;;;++**??????*,,;%%??%SS%@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@,,,,,,..,:;::*%SSS%*%%%%%????***+**?**++*??*+;;;;+****????*:,,,+?%SSSS@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@:,,,,,,,,,:,,,,;*%%%*%%%%%%%??*+++??????*+**?**+*********+;:,,,,,;*SSS@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@:,,,,,,::,,::::::;?%?*?%%%%%%%??***???????**?????*******+::::,,,,,,,@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@:,,,,,,:::,:::::::;*??*%%%%%%%%%?***?*????**?????********::::,,,,,,:@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@:,,,,,,:::::::::::++++*%%%%%%%%%%%?***????+*?????********;:::,,,,,,:@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@,,,,,,:++++;::::::+++;+*?%%%%%%%%%%?***??*+???????*******+++;,,,,,,:@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@,,,,,,:*****:::::;+++;;++*?%%%%%%%%%?***?*+???????**********+,,,,,,,@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@,,,,,,:*****+:,::;++++;;+++*?%%%%%%%%%*****???????**********+,,,,,,,@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@:,,,,,,++++**;,,,:++++++;++++*?%%%%%%%%?**+???????*******++++,,,,,,:@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@:,,,,,,:::;***:,,:++++++;++++++*?%%%%%%%?**+*??****++++++;:::,,,,,,:@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@:,,,,,,::::***+:,:++++++;;;++++++*?%%%%%%?*+*??***+++++++::::,,,,,,:@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@:,,,,,,::::+***;,,;++++++;;;++++++++?%%%%%?***?***+++++++::::,,,,,,;@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@;,,,,,,::::+****;:;+++++++++;+++++++++?%%%???*****+++++*+::::,,,,,,+@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@,,,,,,,:::;****+::;++++++++;;++++++++++?%%???***+++++++;:::,,,,,,,@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@,,,,,,,::::******+++++++++++;;+++++++++++?%??%**+++++++::::,,,,,,,@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@:,,,,,,::::+*********+++++++++;;++;;;++++++?*%%*+++++++::::,,,,,,:@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@:,,,,,,,:::;********??**++++++++;;++;++++++;+*%%?+++++;:::,,,,,,,:@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@,,,,,,,::::+*********???**+++++++++;;;;;;;++::*%%*+++::::,,,,,,,@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@:,,,,,,::::;**********????**+++++++++++;;;+:,,,:*?*+;:::,,,,,,,:@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@:,,,,,,,::::+**********??????**+++++++++++:,,,,,,:**::::,,,,,,,;@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@,,,,,,,:::::+**++++********?*****+++++;;,,,,,,,,,,,:::,,,,,,,:@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@:,,,,,,,::::;*?%%%?**?%%%%%??%%%%%%*??*++:,;++++:,,,,,,,,,,,,,@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@,,,,,,,,::::;S###S**######%S@#####%###@@*;#@@@@S,,,,,,,,,,,,@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@:,,,,,,,:::::S#%##**##%%S#%%%%#S%??%%%S@?+@%**##::::,,,,,,,;@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@,,,,,,,,:::;#S+S#?*##**%#%++?#S+++*%?%#%?@%**##:::,,,,,,,,@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@.,,,,,,,,::*@S?S#%*######%++?#S+*+?####??##@###::,,,,,,,,@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@:,,,,,,,,,?##@##S*##S##S**+?#S+***??%#S+*+++S#:,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@:,,,,,,,,S#*++##*##******+?#S+**SSSS#S*%%%%##:,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@,,,,,,,;#S:,;S#%S#******+?#S++%#####%?#####S:,,,,,,,@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@,,,,,,:;;,:+*?**?*********?***?????**?*+++:,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@,,,,,,,,,,:+***+********************+:,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@:,,,,,,,,,,:+*******************++:,,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@:,,,,,,,,,,,:;++************++;:,,,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:,,,,,,,,,,,,,::;;++++++;;:,,,,,,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@::,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:,,,,,,,,,,,,,,,,,,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@::,,,,,,,,,,,,,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;,,,,,,,,,,,,,,,,:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%:;;;:;%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
```

## Description

### MITRE Description

> [APT39](https://attack.mitre.org/groups/G0087) is an Iranian cyber espionage group that has been active since at least 2014. They have targeted the telecommunication and travel industries to collect personal information that aligns with Iran's national priorities. (Citation: FireEye APT39 Jan 2019)(Citation: Symantec Chafer Dec 2015)

### External Description

> 

## Aliases

```
APT39
Chafer
```

## Known Tools

```
Remexi
PsExec
Mimikatz
Web Shells (aspx spy
b374k)
nbtscan
plink
RemCom
VNC Bypass scanner
CoreSecurity tools
Impacket / Python exploits
NSSM
Remcom
HTTPTunnel
Cadelspy
PLink
SSH Tunnels to Windows Servers
```

## Operations

```

```

## Targets

```
Airlines, Airports, Transportation, Logistics - worldwide
```

## Attribution Links

```
http://www.symantec.com/connect/blogs/iran-based-attackers-use-back-door-threats-spy-middle-eastern-targets
https://www.symantec.com/blogs/threat-intelligence/chafer-latest-attacks-reveal-heightened-ambitions
https://www.fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personal-information.html
https://securelist.com/chafer-used-remexi-malware/89538/
https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-november-helix-kitten/
https://unit42.paloaltonetworks.com/new-python-based-payload-mechaflounder-used-by-chafer/
https://securityintelligence.com/posts/observations-of-itg07-cyber-operations/
https://www.bitdefender.com/files/News/CaseStudies/study/332/Bitdefender-Whitepaper-Chafer-creat4491-en-EN-interactive.pdf
```

## Country

```
iran
```

## Comments

```
Uses the same C2 infrastructure as OilRig
```

# Techniques


* [Spearphishing Attachment](../techniques/Spearphishing-Attachment.md)

* [Spearphishing Link](../techniques/Spearphishing-Link.md)
    
* [Remote Desktop Protocol](../techniques/Remote-Desktop-Protocol.md)
    
* [Registry Run Keys / Startup Folder](../techniques/Registry-Run-Keys---Startup-Folder.md)
    
* [Scheduled Task](../techniques/Scheduled-Task.md)
    
* [Shortcut Modification](../techniques/Shortcut-Modification.md)
    
* [Remote System Discovery](../techniques/Remote-System-Discovery.md)
    
* [Archive via Utility](../techniques/Archive-via-Utility.md)
    
* [Internal Proxy](../techniques/Internal-Proxy.md)
    
* [LSASS Memory](../techniques/LSASS-Memory.md)
    
* [Windows Command Shell](../techniques/Windows-Command-Shell.md)
    
* [Valid Accounts](../techniques/Valid-Accounts.md)
    
* [Network Service Scanning](../techniques/Network-Service-Scanning.md)
    
* [SSH](../techniques/SSH.md)
    
* [Web Shell](../techniques/Web-Shell.md)
    
* [Malicious File](../techniques/Malicious-File.md)
    
* [Software Packing](../techniques/Software-Packing.md)
    
* [System Owner/User Discovery](../techniques/System-Owner-User-Discovery.md)
    
* [Malicious Link](../techniques/Malicious-Link.md)
    
* [Brute Force](../techniques/Brute-Force.md)
    
* [Credentials from Password Stores](../techniques/Credentials-from-Password-Stores.md)
    
* [External Proxy](../techniques/External-Proxy.md)
    
* [Local Account](../techniques/Local-Account.md)
    
* [Service Execution](../techniques/Service-Execution.md)
    
* [Network Share Discovery](../techniques/Network-Share-Discovery.md)
    
* [PowerShell](../techniques/PowerShell.md)
    
* [Bidirectional Communication](../techniques/Bidirectional-Communication.md)
    
* [DNS](../techniques/DNS.md)
    
* [Python](../techniques/Python.md)
    
* [Web Protocols](../techniques/Web-Protocols.md)
    
* [OS Credential Dumping](../techniques/OS-Credential-Dumping.md)
    
* [SMB/Windows Admin Shares](../techniques/SMB-Windows-Admin-Shares.md)
    
* [Ingress Tool Transfer](../techniques/Ingress-Tool-Transfer.md)
    
* [Clipboard Data](../techniques/Clipboard-Data.md)
    
* [Data from Local System](../techniques/Data-from-Local-System.md)
    
* [Keylogging](../techniques/Keylogging.md)
    
* [Screen Capture](../techniques/Screen-Capture.md)
    
* [Exploit Public-Facing Application](../techniques/Exploit-Public-Facing-Application.md)
    
* [Match Legitimate Name or Location](../techniques/Match-Legitimate-Name-or-Location.md)
    

# Malwares


* [ASPXSpy](../malwares/ASPXSpy.md)

* [Remexi](../malwares/Remexi.md)
    
* [Cadelspy](../malwares/Cadelspy.md)
    
* [MechaFlounder](../malwares/MechaFlounder.md)
    

# Tools


* [PsExec](../tools/PsExec.md)

* [Mimikatz](../tools/Mimikatz.md)
    
* [Windows Credential Editor](../tools/Windows-Credential-Editor.md)
    
* [pwdump](../tools/pwdump.md)
    
